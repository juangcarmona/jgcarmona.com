# Copilot Instructions for jgcarmona.com

## Project Overview
This is an **Astro-based blog migration** from WordPress. The project uses Astro 5.x with MDX support for content publishing, migrating a large archive of blog posts (~200+ articles) from a WordPress site to a modern static site generator.

## Architecture Essentials

### Content Structure
- **Location**: `src/content/blog/` - all blog posts live here
- **Format**: Markdown (`.md`) or MDX (`.mdx`) with frontmatter
- **Schema** (`src/content.config.ts`):
  - `title` (required, string)
  - `description` (required, string)
  - `pubDate` (required, ISO date string - coerced to Date)
  - `updatedDate` (optional, ISO date string)
  - `heroImage` (optional, image reference)
- **Organization**: Each post is either a single `.md` file or a directory with `index.md` + images folder (e.g., `ai-agents-nutshell/index.md` + `ai-agents-nutshell/images/`)

### Key Files & Responsibilities
- **`src/pages/[...slug].astro`** - Dynamic route handler for individual blog posts. Uses `getStaticPaths()` with Astro's content API.
- **`src/pages/index.astro`** - Homepage with paginated blog listing (10 posts per page + 1).
- **`src/layouts/BlogPost.astro`** - Main blog post layout wrapping content with hero image, metadata, footer.
- **`src/components/BlogPage.astro`** - Paginated listing component used by homepage.
- **`src/consts.ts`** - Global site constants (SITE_TITLE, SITE_DESCRIPTION).
- **`astro.config.mjs`** - Integrations: MDX, sitemap generation.

### Content Rendering Pipeline
1. Posts are loaded via glob pattern in `content.config.ts`
2. `[...slug].astro` uses `getCollection('blog')` to fetch all posts
3. `render()` is called to convert markdown/MDX to HTML Component
4. Component is rendered within `BlogPost.astro` layout
5. Blog listing pages (`index.astro`, pagination) fetch all posts and sort by `pubDate` descending

### Styling
- Global styles in `src/styles/global.css`
- Component-scoped styles within `<style>` blocks in `.astro` files
- Responsive design pattern: `width: calc(100% - 2em); max-width: [target]px;`
- Theme uses CSS variables (e.g., `--gray-light`, `--box-shadow`)

## Development Workflow

### Commands
```bash
npm run dev      # Start dev server (HMR enabled)
npm run build    # Build for production (SSG)
npm run preview  # Preview production build locally
npm run astro    # Access raw Astro CLI
```

### Adding New Blog Posts
1. Create directory in `src/content/blog/post-slug/` with `index.md`
2. Add frontmatter with required fields (title, description, pubDate)
3. Optional: Add images in `post-slug/images/` and reference with relative paths
4. Save - dev server hot-reloads automatically

### Content Patterns from Codebase
- Posts are heavily bilingual (Spanish/English titles and content)
- Archive spans 200+ posts on diverse topics (architecture, AI, DevOps, soft skills)
- Posts use standard markdown heading structure; content validates against schema in `content.config.ts`

## TypeScript & Type Safety
- **tsconfig.json** extends `astro/tsconfigs/strict` with `strictNullChecks: true`
- Props are typed in components using `interface Props` pattern (see `BlogPage.astro`)
- Content entries use `CollectionEntry<'blog'>` type for type-safe post metadata

## Integration Points
- **Image optimization**: Uses `astro:assets` with Sharp for image processing
- **RSS feed**: `rss.xml.js` generates feed (via `@astrojs/rss`)
- **Sitemap**: Auto-generated by `@astrojs/sitemap` integration
- **MDX rendering**: `@astrojs/mdx` enables JSX/components inside markdown

## Common Patterns & Conventions
1. **Pagination logic**: Smart compact pagination showing boundary + adjacent pages (see `index.astro` lines 16-33)
2. **Post sorting**: Always sort by `pubDate` descending for chronological display
3. **Comments integration**: `Comments.astro` component injected in blog layout (purpose TBD)
4. **Image asset loading**: Use `Image` component from `astro:assets` for responsive images with lazy loading

## Current Development Branch
The project is on branch `slog-rework` - changes may relate to structured logging or refactoring.

## Key Decisions & Trade-offs
- **Static generation over dynamic**: All routes are pre-rendered at build time (no server-side rendering)
- **Content-first approach**: Blog content is source of truth; no database backend
- **MDX over markdown-only**: Allows rich components in posts while maintaining markdown writeability
